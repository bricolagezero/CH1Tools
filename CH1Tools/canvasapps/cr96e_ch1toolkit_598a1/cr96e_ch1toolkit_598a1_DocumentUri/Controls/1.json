{
  "TopParent": {
    "Type": "ControlInfo",
    "Name": "App",
    "Template": {
      "Id": "http://microsoft.com/appmagic/appinfo",
      "Version": "1.0",
      "LastModifiedTimestamp": "0",
      "Name": "appinfo",
      "FirstParty": true,
      "IsPremiumPcfControl": false,
      "IsCustomGroupControlTemplate": false,
      "CustomGroupControlTemplateName": "",
      "IsComponentDefinition": false,
      "OverridableProperties": {}
    },
    "Index": 0,
    "PublishOrderIndex": 0,
    "VariantName": "",
    "LayoutName": "",
    "MetaDataIDKey": "",
    "PersistMetaDataIDKey": false,
    "IsFromScreenLayout": false,
    "StyleName": "",
    "Parent": "",
    "IsDataControl": true,
    "AllowAccessToGlobals": true,
    "OptimizeForDevices": "Off",
    "IsGroupControl": false,
    "IsAutoGenerated": false,
    "Rules": [
      {
        "Property": "ConfirmExit",
        "Category": "Data",
        "InvariantScript": "false",
        "RuleProviderType": "Unknown"
      },
      {
        "Property": "BackEnabled",
        "Category": "Data",
        "InvariantScript": "true",
        "RuleProviderType": "Unknown"
      },
      {
        "Property": "MinScreenHeight",
        "Category": "Design",
        "InvariantScript": "320",
        "RuleProviderType": "Unknown"
      },
      {
        "Property": "MinScreenWidth",
        "Category": "Design",
        "InvariantScript": "320",
        "RuleProviderType": "Unknown"
      },
      {
        "Property": "Theme",
        "Category": "Design",
        "InvariantScript": "'CH1 Theme'",
        "RuleProviderType": "Unknown"
      },
      {
        "Property": "OnStart",
        "Category": "Behavior",
        "InvariantScript": "// ✳️ 0) Set default folder path\r\nSet(varRootPath, \"Content Templates/Business Development/Capabilities/\");\r\n\r\n// ✳️ 1) Load SharePoint doc library into ContentLibrary\r\nClearCollect(\r\n    ContentLibrary,\r\n    Filter(\r\n        'Content Templates',\r\n        'Folder path' = varRootPath\r\n    )\r\n);\r\n\r\n// ✳️ 2) Seed colDocPanelCrumbs with correct schema\r\nClearCollect(\r\n    colDocPanelCrumbs,\r\n    Table(\r\n        {\r\n            Title: \"\",\r\n            Path: \"\"\r\n        }\r\n    )\r\n);\r\nClear(colDocPanelCrumbs); // wipe dummy row\r\n\r\n// ✳️ 3) Add first breadcrumb from varRootPath\r\nWith(\r\n    {\r\n        folderParts: Split(Left(varRootPath, Len(varRootPath) - 1), \"/\")\r\n    },\r\n    Collect(\r\n        colDocPanelCrumbs,\r\n        {\r\n            Title: Text(Last(folderParts).Value), // <-- Text() ensures type safety\r\n            Path: varRootPath\r\n        }\r\n    )\r\n);\r\n\r\n// ✳️ 4) Seed pill collections (clean start)\r\nClearCollect(colKBCatPick, { Cat: \"\" });\r\nClear(colKBCatPick);\r\n\r\nClearCollect(colCatPick, { Value: \"\" });\r\nClear(colCatPick);  // Clean up empty record\r\n\r\n// ✳️ 5) Independent setup (parallel)\r\nConcurrent(\r\n    Set(varKBOpen, false),\r\n    Set(varKBMode, \"View\"),\r\n    Set(varKBCurrent, Blank()),\r\n    ClearCollect(\r\n        colMenu,\r\n         { ID: 1, Title: \"Launch Pad\", ScreenName: LaunchPad },\r\n         { ID: 2, Title: \"Brain Stash\", ScreenName: BrainStash },\r\n         { ID: 3, Title: \"The Pantry\",  ScreenName: ThePantry }\r\n    )\r\n);\r\n\r\n// ✳️ 6) Build unique category list from actual document metadata\r\nClearCollect(\r\n    colCategoryStrings,\r\n    ForAll(\r\n        Filter(ContentLibrary, !IsBlank(Category.Value)),\r\n        { CategoryText: Category.Value }\r\n    )\r\n);\r\n",
        "RuleProviderType": "User"
      },
      {
        "Property": "SizeBreakpoints",
        "Category": "ConstantData",
        "InvariantScript": "[600, 900, 1200]",
        "RuleProviderType": "Unknown"
      }
    ],
    "ControlPropertyState": [
      {
        "InvariantPropertyName": "OnStart",
        "AutoRuleBindingEnabled": false,
        "AutoRuleBindingString": "// seed schema for the component's crumb list (avoids \"name isn't valid\" during authoring)\nClearCollect(colDocPanelCrumbs, { ID: 0, DisplayName: \"\" });\nClear(colDocPanelCrumbs);\n\nClearCollect(colKBCatPick, { Cat: \"\" });\nClear(colKBCatPick);\n\n// 2) Independent setup (parallel)\nConcurrent(\n    Set(varKBOpen, false),\n    Set(varKBMode, \"View\"),\n    Set(varKBCurrent, Blank()),\n    ClearCollect(\n        colMenu,\n         { ID: 1, Title: \"Launch Pad\", ScreenName: LaunchPad },\n        { ID: 2, Title: \"Brain Stash\", ScreenName: BrainStash },\n        { ID: 3, Title: \"The Pantry\",           ScreenName: ThePantry },\n         { ID: 4, Title: \"Client Depot\",           ScreenName: ClientDepot},\n          { ID: 5, Title: \"Becca Bot\",           ScreenName: BeccaBot }\n\n    )\n)\n\n",
        "NameMapSourceSchema": "?",
        "IsLockable": false,
        "AFDDataSourceName": ""
      },
      "MinScreenHeight",
      "MinScreenWidth",
      "ConfirmExit",
      "SizeBreakpoints",
      "BackEnabled",
      "Theme"
    ],
    "IsLocked": false,
    "ControlUniqueId": "1",
    "Children": [
      {
        "Type": "ControlInfo",
        "Name": "Host",
        "HasDynamicProperties": false,
        "Template": {
          "Id": "http://microsoft.com/appmagic/hostcontrol",
          "Version": "1.6.0",
          "LastModifiedTimestamp": "0",
          "Name": "hostControl",
          "FirstParty": true,
          "IsPremiumPcfControl": false,
          "IsCustomGroupControlTemplate": false,
          "CustomGroupControlTemplateName": "",
          "IsComponentDefinition": false,
          "HostType": "Default",
          "OverridableProperties": {}
        },
        "Index": 0,
        "PublishOrderIndex": 0,
        "VariantName": "DefaultHostControlVariant",
        "LayoutName": "",
        "MetaDataIDKey": "",
        "PersistMetaDataIDKey": false,
        "IsFromScreenLayout": false,
        "StyleName": "",
        "Parent": "App",
        "IsDataControl": true,
        "AllowAccessToGlobals": true,
        "OptimizeForDevices": "Off",
        "IsGroupControl": false,
        "IsAutoGenerated": false,
        "Rules": [
          {
            "Property": "OnNew",
            "Category": "Behavior",
            "InvariantScript": "false",
            "RuleProviderType": "Unknown"
          },
          {
            "Property": "OnEdit",
            "Category": "Behavior",
            "InvariantScript": "false",
            "RuleProviderType": "Unknown"
          },
          {
            "Property": "OnView",
            "Category": "Behavior",
            "InvariantScript": "false",
            "RuleProviderType": "Unknown"
          },
          {
            "Property": "OnSave",
            "Category": "Behavior",
            "InvariantScript": "false",
            "RuleProviderType": "Unknown"
          },
          {
            "Property": "OnCancel",
            "Category": "Behavior",
            "InvariantScript": "false",
            "RuleProviderType": "Unknown"
          }
        ],
        "ControlPropertyState": [
          "OnNew",
          "OnEdit",
          "OnView",
          "OnSave",
          "OnCancel"
        ],
        "IsLocked": false,
        "ControlUniqueId": "3",
        "Children": []
      }
    ]
  }
}