# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
App:
  Properties:
    OnStart: |+
      =Set(varRootPath, "Content Templates/");
      Set(varActiveFolder, varRootPath);

      ClearCollect(
          ContentLibrary,
          Filter(
              'Content Templates',
              StartsWith('Folder path', varRootPath)
          )
      );

      ClearCollect(
          colDocPanelCrumbs,
          Table(
              {
                  Title: "",
                  Path: ""
              }
          )
      );
      Clear(colDocPanelCrumbs);
      With(
          {
              folderParts: Split(Left(varRootPath, Len(varRootPath) - 1), "/")
          },
          Collect(
              colDocPanelCrumbs,
              {
                  Title: Text(Last(folderParts).Value),
                  Path: varRootPath
              }
          )
      );

      ClearCollect(colKBCatPick, { Cat: "" });
      Clear(colKBCatPick);

      ClearCollect(colCatPick, { Value: "" });
      Clear(colCatPick);

      Concurrent(
          Set(varKBOpen, false),
          Set(varKBMode, "View"),
          Set(varKBCurrent, Blank()),
          ClearCollect(
              colMenu,
              { ID: 1, Title: "Launch Pad", ScreenName: LaunchPad },
              { ID: 2, Title: "Brain Stash", ScreenName: BrainStash },
              { ID: 3, Title: "The Pantry", ScreenName: ThePantry }
          )
      );

      ClearCollect(
          colCategoryStrings,
          ForAll(
              Filter(
                  ContentLibrary,
                  'Folder path' = varActiveFolder,
                  !IsBlank(Category.Value)
              ),
              { CategoryText: Category.Value }
          )
      );

    Theme: ='CH1 Theme'
